#include <unistd.h>
#include <stdio.h>

/*
This program is used to test the scanning functionality of the sanitizer module of AntibIoTic.
The buffer that is allocated should be present somewhere in the executable, so the sanitizer will be able search for this value.
Note that the compiler may not store the buffer in one long sequence, so check if the binary contains the search sequence.
*/

int main(int argc, char **args){
  /* 
   * The pattern has been taken from Mirai (https://github.com/jgamblin/Mirai-Source-Code/blob/master/mirai/bot/table.c)
   * This is the string '.anime' encoded with the Mirai string encoding tool (https://github.com/jgamblin/Mirai-Source-Code/blob/master/mirai/tools/enc.c)
   */
  char buf[] = "\x0C\x43\x4C\x4B\x4F\x47\x22";
  printf("PID: %d\n", (int)getpid());
  printf("GPID: %d\n", (int)getpgrp());
  while(1){
	getchar();
  }
}
